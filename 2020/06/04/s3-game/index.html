<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>S3 Game | A Random Walk</title>
<meta name="keywords" content="aws">
<meta name="description" content="Level up your S3 skills by playing this game!">
<meta name="author" content="Raunak">
<link rel="canonical" href="https://rrampage.github.io/2020/06/04/s3-game/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.3583c276be8b676922334220eddb70a58dd857f110640a70a4641bbbc371cae2.css" integrity="sha256-NYPCdr6LZ2kiM0Ig7dtwpY3YV/EQZApwpGQbu8NxyuI=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://rrampage.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://rrampage.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://rrampage.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://rrampage.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://rrampage.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="S3 Game" />
<meta property="og:description" content="Level up your S3 skills by playing this game!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rrampage.github.io/2020/06/04/s3-game/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-06-04T16:09:34+00:00" />
<meta property="article:modified_time" content="2020-06-04T16:09:34+00:00" /><meta property="og:site_name" content="A Random Walk" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="S3 Game"/>
<meta name="twitter:description" content="Level up your S3 skills by playing this game!"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://rrampage.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "S3 Game",
      "item": "https://rrampage.github.io/2020/06/04/s3-game/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "S3 Game",
  "name": "S3 Game",
  "description": "Level up your S3 skills by playing this game!",
  "keywords": [
    "aws"
  ],
  "articleBody": "Introduction The best way to learn a skill is through deliberate practice! S3 Game is an awesome game made by Vasily Pantyukhin which walks you through various features of S3 from beginner to fairly advanced.\nWhat you will need: A browser aws cli CLICK HERE TO PLAY! Each level consists of finding a “treasure” object and getting to the next level using the secret code in the “treasure”.\nGo ahead and play this game. Each level contains multiple hints with links to S3 API documentation.\nBelow is a walk through you can refer to if you are stuck on any level. Make sure that you try for a bit before seeing here :)\nWalk through (Spoilers) Level 1 Solution: # List the objects in bucket aws s3 ls s3://s3game-level1 Visit the treasure object\nLevel 2 Solution: Just get the treasure2 object either using browser or aws s3 : https://s3game-level2.s3.us-east-2.amazonaws.com/treasure2 Make sure to save the Access and Secret key somewhere\nLevel 3 Create an AWS profile “tmp” with the access and secret key obtained from previous level. You will need to use this for almost every level from here on.\naws configure --profile tmp \u003e AWS Access Key ID \u003e AWS Secret Access Key \u003e Default region name - us-east-2 Solution: aws s3 ls s3://s3game-level3 --profile tmp aws s3 cp s3://s3game-level3/treasure3_has_no_secret_code . --profile tmp cat treasure3_has_no_secret_code # The object data itself does not have the secret code. It is present in the metadata aws s3api head-object --bucket s3game-level3 --key treasure3_has_no_secret_code --profile tmp Level 4 Hint Solution: # List the bucket .. # get the file aws s3 cp s3://s3game-level4-k73045aztqln/treasure4_also_has_no_secret_code . --profile tmp # looks like the data is empty aws s3api head-object --bucket s3game-level4-k73045aztqln --profile tmp --key treasure4_also_has_no_secret_code # ... so is the metadata. Let's try object tags as mentioned in hint aws s3api get-object-tagging --bucket s3game-level4-k73045aztqln --profile tmp --key treasure4_also_has_no_secret_code Takeaway: Object in S3, including its metadata, is immutable. When you edit object’s metadata, you are actually overwriting the object with a copy of itself, with its metadata modified. In contrast, tags are subresources. They are managed separately and can be modified without modifying the object itself.\nLevel 5 Hint Hint Hint Solution # We are listing all versions of objects as the hint says that the object is not present in its current version aws s3api list-object-versions --bucket s3game-level5-8v95e5rv7z4i --profile tmp # Get the specific version of treasure5_is_deleted using version-id from previous call aws s3api get-object --bucket 's3game-level5-8v95e5rv7z4i' --key treasure5_is_deleted --version-id '344PQOyFqocF0TI66MbLynNNdQqHfBz3' --profile tmp treasure5_is_deleted Takeaway S3 versioning keeps multiple variants of an object in the same bucket. If you enable versioning for a bucket, S3 automatically generates a unique version ID for the object being stored. In one bucket you can have two objects with the same key, but different version IDs. Check if versioning is enabled using: aws s3api get-bucket-versioning --bucket my-bucket\nLevel 6 Hint Solution # We need to get a gzipped object using S3 select aws s3api list-objects --bucket s3game-level6-vjv45x1gux81 --profile tmp # Now, do the select on s3select.csv.gz aws s3api select-object-content --bucket s3game-level6-vjv45x1gux81 --key s3select.csv.gz --expression \"SELECT s.Answer FROM s3object s WHERE Category = 'TREASURE'\" --expression-type sql --input-serialization '{\"CSV\": {\"FileHeaderInfo\": \"USE\", \"FieldDelimiter\": \";\"}, \"CompressionType\": \"GZIP\"}' --output-serialization '{\"CSV\": {}}' --profile tmp treasure6 Level 7 Hint Solution # Get 'somethingstrange' from the bucket aws s3api get-object --bucket s3game-level7-zhovpo4j8588 --key somethingstrange --profile tmp t7 cat t7 # Visit the pre-signed URL in the file to get URL for next level Takeaway Pre-signed URLs are a powerful feature of S3. From the docs:\nA presigned URL is generated by an AWS user who has access to the object. The generated URL is then given to the unauthorized user. The presigned URL can be entered in a browser or used by a program or HTML webpage. The credentials used by the presigned URL are those of the AWS user who generated the URL.\nA presigned URL remains valid for a limited period of time which is specified when the URL is generated.\nLevel 8 Solution # List objects aws s3api list-objects --bucket s3game-level8-v6g8tp7ra2ld --profile tmp # Visit the treasure file using the cloudfront URL curl 'https://d2suiw06vujwz3.cloudfront.net/treasure8_CDN' Takeaway You can easily create a Cloudfront distribution backed by an S3 bucket In such cases, you can restrict public access for the objects in the bucket as they can be accessed using Cloudfront Ensure that your bucket does not allow unprivileged users to list all objects in the bucket Level 9 Hint The bucket has a policy which checks that any request for “arn:aws:s3:::s3game-level9-781xtls2quvy/treasure9_referer” has the referer string “http://s3game.treasure”\nSolution All we need to do is curl with a –refer given in policy curl ‘https://s3game-level9-781xtls2quvy.s3.us-east-2.amazonaws.com/treasure9_referer' –refer ‘http://s3game.treasure’\nLevel 10 Here, we need to fetch an object which is in Infrequent Access storage.\nSolution # We can use the powerful query param of aws cli to just fetch those objects which are in infrequent access storgae aws s3api list-objects --bucket s3game-level10-gac6tf83erp6 --query 'Contents[?StorageClass == `STANDARD_IA`]' --profile tmp Takeaway Amazon S3 offers a range of storage classes designed for different use cases:\nStandard for general-purpose storage of frequently accessed data Intelligent-Tiering for data with unknown or changing access patterns Standard-Infrequent Access (Standard-IA) and One Zone-Infrequent Access (One Zone-IA) for long-lived, but less frequently accessed data Glacier and Glacier Deep Archive for long-term archive Level 11 Here we need to fetch an object which has been encrypted using client side encryption and uploaded to S3. This means that we can not fetch the object unless we have the encryption key.\nSolution # The encryption key is given in the hint aws s3 cp --sse-c 'AES256' --sse-c-key 'UkXp2s5v8y/B?E(H+MbPeShVmYq3t6w9' 's3://s3game-level11-djq30a807iyq/treasure11_encryption' --profile tmp . # Alternate way using aws s3api. Here we also need to give md5 of encryption key as additional integrity check aws s3api get-object --bucket s3game-level11-djq30a807iyq --key treasure11_encryption --sse-customer-key 'UkXp2s5v8y/B?E(H+MbPeShVmYq3t6w9' --sse-customer-algorithm AES256 --profile tmp treasure11_encryption Takeaway S3 supports both server side and client side encryption.\nVICTORY! - Level 12 Congrats! You have cleared the game!\n",
  "wordCount" : "990",
  "inLanguage": "en",
  "datePublished": "2020-06-04T16:09:34.525Z",
  "dateModified": "2020-06-04T16:09:34.525Z",
  "author":{
    "@type": "Person",
    "name": "Raunak"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://rrampage.github.io/2020/06/04/s3-game/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "A Random Walk",
    "logo": {
      "@type": "ImageObject",
      "url": "https://rrampage.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://rrampage.github.io/" accesskey="h" title="A Random Walk (Alt + H)">A Random Walk</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://rrampage.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://rrampage.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://rrampage.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://rrampage.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      S3 Game
    </h1>
    <div class="post-description">
      Level up your S3 skills by playing this game!
    </div>
    <div class="post-meta">June 4 2020   5 min

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#what-you-will-need">What you will need:</a></li>
        <li><a href="#click-herehttps3game-level1s3-websiteus-east-2amazonawscom-to-play"><strong>CLICK <a href="http://s3game-level1.s3-website.us-east-2.amazonaws.com/">HERE</a> TO PLAY!</strong></a></li>
      </ul>
    </li>
    <li><a href="#walk-through-spoilers">Walk through (Spoilers)</a>
      <ul>
        <li><a href="#level-1https3game-level1s3-websiteus-east-2amazonawscomlevel1html"><a href="http://s3game-level1.s3-website.us-east-2.amazonaws.com/level1.html">Level 1</a></a></li>
        <li><a href="#level-2httpss3game-level2s3us-east-2amazonawscomlevel2-748l6b6xwzl6html"><a href="https://s3game-level2.s3.us-east-2.amazonaws.com/level2-748l6b6xwzl6.html">Level 2</a></a></li>
        <li><a href="#level-3httpss3game-level3s3us-east-2amazonawscomlevel3-76qp7mlpzyg1html"><a href="https://s3game-level3.s3.us-east-2.amazonaws.com/level3-76qp7mlpzyg1.html">Level 3</a></a></li>
        <li><a href="#level-4httpss3game-level4-k73045aztqlns3us-east-2amazonawscomlevel4html"><a href="https://s3game-level4-k73045aztqln.s3.us-east-2.amazonaws.com/level4.html">Level 4</a></a></li>
        <li><a href="#level-5httpss3game-level5-8v95e5rv7z4is3us-east-2amazonawscomlevel5html"><a href="https://s3game-level5-8v95e5rv7z4i.s3.us-east-2.amazonaws.com/level5.html">Level 5</a></a></li>
        <li><a href="#level-6httpss3game-level6-vjv45x1gux81s3us-east-2amazonawscomlevel6html"><a href="https://s3game-level6-vjv45x1gux81.s3.us-east-2.amazonaws.com/level6.html">Level 6</a></a></li>
        <li><a href="#level-7httpss3game-level7-zhovpo4j8588s3us-east-2amazonawscomlevel7html"><a href="https://s3game-level7-zhovpo4j8588.s3.us-east-2.amazonaws.com/level7.html">Level 7</a></a></li>
        <li><a href="#level-8httpss3game-level8-v6g8tp7ra2lds3us-east-2amazonawscomlevel8html"><a href="https://s3game-level8-v6g8tp7ra2ld.s3.us-east-2.amazonaws.com/level8.html">Level 8</a></a></li>
        <li><a href="#level-9httpss3game-level9-781xtls2quvys3us-east-2amazonawscomlevel9html"><a href="https://s3game-level9-781xtls2quvy.s3.us-east-2.amazonaws.com/level9.html">Level 9</a></a></li>
        <li><a href="#level-10httpss3game-level10-gac6tf83erp6s3us-east-2amazonawscomlevel10html"><a href="https://s3game-level10-gac6tf83erp6.s3.us-east-2.amazonaws.com/level10.html">Level 10</a></a></li>
        <li><a href="#level-11httpss3game-level11-djq30a807iyqs3us-east-2amazonawscomlevel11html"><a href="https://s3game-level11-djq30a807iyq.s3.us-east-2.amazonaws.com/level11.html">Level 11</a></a></li>
        <li><a href="#victory---level-12httpss3game-level12-bk0m5ax5n92os3us-east-2amazonawscomlevel12html">VICTORY! - <a href="https://s3game-level12-bk0m5ax5n92o.s3.us-east-2.amazonaws.com/level12.html">Level 12</a></a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>The best way to learn a skill is through deliberate practice!
<a href="http://s3game-level1.s3-website.us-east-2.amazonaws.com/">S3 Game</a> is an awesome game made by <a href="https://www.linkedin.com/in/vpantyukhin/">Vasily Pantyukhin</a> which walks you through various features of S3 from beginner to fairly advanced.</p>
<h3 id="what-you-will-need">What you will need:<a hidden class="anchor" aria-hidden="true" href="#what-you-will-need">#</a></h3>
<ul>
<li>A browser</li>
<li><a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html">aws cli</a></li>
</ul>
<h3 id="click-herehttps3game-level1s3-websiteus-east-2amazonawscom-to-play"><strong>CLICK <a href="http://s3game-level1.s3-website.us-east-2.amazonaws.com/">HERE</a> TO PLAY!</strong><a hidden class="anchor" aria-hidden="true" href="#click-herehttps3game-level1s3-websiteus-east-2amazonawscom-to-play">#</a></h3>
<p>Each level consists of finding a &ldquo;treasure&rdquo; object and getting to the next level using the secret code in the &ldquo;treasure&rdquo;.</p>
<p>Go ahead and play this game. Each level contains multiple hints with links to S3 API documentation.</p>
<p>Below is a walk through you can refer to if you are stuck on any level. Make sure that you try for a bit before seeing here :)</p>
<h2 id="walk-through-spoilers">Walk through (Spoilers)<a hidden class="anchor" aria-hidden="true" href="#walk-through-spoilers">#</a></h2>
<h3 id="level-1https3game-level1s3-websiteus-east-2amazonawscomlevel1html"><a href="http://s3game-level1.s3-website.us-east-2.amazonaws.com/level1.html">Level 1</a><a hidden class="anchor" aria-hidden="true" href="#level-1https3game-level1s3-websiteus-east-2amazonawscomlevel1html">#</a></h3>
<h4 id="solution">Solution:<a hidden class="anchor" aria-hidden="true" href="#solution">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># List the objects in bucket</span>
</span></span><span class="line"><span class="cl">aws s3 ls s3://s3game-level1
</span></span></code></pre></div><p>Visit the <a href="http://s3game-level1.s3-website.us-east-2.amazonaws.com/treasure1">treasure object</a></p>
<h3 id="level-2httpss3game-level2s3us-east-2amazonawscomlevel2-748l6b6xwzl6html"><a href="https://s3game-level2.s3.us-east-2.amazonaws.com/level2-748l6b6xwzl6.html">Level 2</a><a hidden class="anchor" aria-hidden="true" href="#level-2httpss3game-level2s3us-east-2amazonawscomlevel2-748l6b6xwzl6html">#</a></h3>
<h4 id="solution-1">Solution:<a hidden class="anchor" aria-hidden="true" href="#solution-1">#</a></h4>
<p>Just get the treasure2 object either using browser or aws s3 : <a href="https://s3game-level2.s3.us-east-2.amazonaws.com/treasure2">https://s3game-level2.s3.us-east-2.amazonaws.com/treasure2</a>
Make sure to save the Access and Secret key somewhere</p>
<h3 id="level-3httpss3game-level3s3us-east-2amazonawscomlevel3-76qp7mlpzyg1html"><a href="https://s3game-level3.s3.us-east-2.amazonaws.com/level3-76qp7mlpzyg1.html">Level 3</a><a hidden class="anchor" aria-hidden="true" href="#level-3httpss3game-level3s3us-east-2amazonawscomlevel3-76qp7mlpzyg1html">#</a></h3>
<p>Create an AWS profile &ldquo;tmp&rdquo; with the access and secret key obtained from previous level. You will need to use this for almost every level from here on.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">aws configure --profile tmp
</span></span><span class="line"><span class="cl">&gt; AWS Access Key ID
</span></span><span class="line"><span class="cl">&gt; AWS Secret Access Key
</span></span><span class="line"><span class="cl">&gt; Default region name - us-east-2
</span></span></code></pre></div><h4 id="solution-2">Solution:<a hidden class="anchor" aria-hidden="true" href="#solution-2">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">aws s3 ls s3://s3game-level3 --profile tmp
</span></span><span class="line"><span class="cl">aws s3 cp s3://s3game-level3/treasure3_has_no_secret_code . --profile tmp
</span></span><span class="line"><span class="cl">cat treasure3_has_no_secret_code
</span></span><span class="line"><span class="cl"><span class="c1"># The object data itself does not have the secret code. It is present in the metadata</span>
</span></span><span class="line"><span class="cl">aws s3api head-object --bucket s3game-level3 --key treasure3_has_no_secret_code --profile tmp
</span></span></code></pre></div><h3 id="level-4httpss3game-level4-k73045aztqlns3us-east-2amazonawscomlevel4html"><a href="https://s3game-level4-k73045aztqln.s3.us-east-2.amazonaws.com/level4.html">Level 4</a><a hidden class="anchor" aria-hidden="true" href="#level-4httpss3game-level4-k73045aztqlns3us-east-2amazonawscomlevel4html">#</a></h3>
<ul>
<li><a href="https://s3game-level4-k73045aztqln.s3.us-east-2.amazonaws.com/level4-hint2.html">Hint</a></li>
</ul>
<h4 id="solution-3">Solution:<a hidden class="anchor" aria-hidden="true" href="#solution-3">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># List the bucket ..</span>
</span></span><span class="line"><span class="cl"><span class="c1"># get the file</span>
</span></span><span class="line"><span class="cl">aws s3 cp s3://s3game-level4-k73045aztqln/treasure4_also_has_no_secret_code . --profile tmp
</span></span><span class="line"><span class="cl"><span class="c1"># looks like the data is empty</span>
</span></span><span class="line"><span class="cl">aws s3api head-object --bucket s3game-level4-k73045aztqln --profile tmp --key treasure4_also_has_no_secret_code
</span></span><span class="line"><span class="cl"><span class="c1"># ... so is the metadata. Let&#39;s try object tags as mentioned in hint</span>
</span></span><span class="line"><span class="cl">aws s3api get-object-tagging --bucket s3game-level4-k73045aztqln --profile tmp --key treasure4_also_has_no_secret_code
</span></span></code></pre></div><h4 id="takeaway">Takeaway:<a hidden class="anchor" aria-hidden="true" href="#takeaway">#</a></h4>
<blockquote>
<p>Object in S3, including its metadata, is immutable. When you edit object&rsquo;s metadata, you are actually overwriting the object with a copy of itself, with its metadata modified.
In contrast, tags are subresources. They are managed separately and can be modified without modifying the object itself.</p>
</blockquote>
<h3 id="level-5httpss3game-level5-8v95e5rv7z4is3us-east-2amazonawscomlevel5html"><a href="https://s3game-level5-8v95e5rv7z4i.s3.us-east-2.amazonaws.com/level5.html">Level 5</a><a hidden class="anchor" aria-hidden="true" href="#level-5httpss3game-level5-8v95e5rv7z4is3us-east-2amazonawscomlevel5html">#</a></h3>
<ul>
<li><a href="https://s3game-level5-8v95e5rv7z4i.s3.us-east-2.amazonaws.com/level5-hint2.html">Hint</a></li>
<li><a href="https://s3game-level5-8v95e5rv7z4i.s3.us-east-2.amazonaws.com/level5-hint3.html">Hint</a></li>
<li><a href="https://s3game-level5-8v95e5rv7z4i.s3.us-east-2.amazonaws.com/level5-hint4.html">Hint</a></li>
</ul>
<h4 id="solution-4">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-4">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># We are listing all versions of objects as the hint says that the object is not present in its current version</span>
</span></span><span class="line"><span class="cl">aws s3api list-object-versions --bucket s3game-level5-8v95e5rv7z4i --profile tmp
</span></span><span class="line"><span class="cl"><span class="c1"># Get the specific version of treasure5_is_deleted using version-id from previous call</span>
</span></span><span class="line"><span class="cl">aws s3api get-object --bucket <span class="s1">&#39;s3game-level5-8v95e5rv7z4i&#39;</span> --key treasure5_is_deleted --version-id <span class="s1">&#39;344PQOyFqocF0TI66MbLynNNdQqHfBz3&#39;</span> --profile tmp treasure5_is_deleted
</span></span></code></pre></div><h4 id="takeaway-1">Takeaway<a hidden class="anchor" aria-hidden="true" href="#takeaway-1">#</a></h4>
<blockquote>
<p>S3 versioning keeps multiple variants of an object in the same bucket.
If you enable versioning for a bucket, S3 automatically generates a unique version ID for the object being stored.
In one bucket you can have two objects with the same key, but different version IDs.
Check if versioning is enabled using: <code>aws s3api get-bucket-versioning --bucket my-bucket</code></p>
</blockquote>
<h3 id="level-6httpss3game-level6-vjv45x1gux81s3us-east-2amazonawscomlevel6html"><a href="https://s3game-level6-vjv45x1gux81.s3.us-east-2.amazonaws.com/level6.html">Level 6</a><a hidden class="anchor" aria-hidden="true" href="#level-6httpss3game-level6-vjv45x1gux81s3us-east-2amazonawscomlevel6html">#</a></h3>
<ul>
<li><a href="https://s3game-level6-vjv45x1gux81.s3.us-east-2.amazonaws.com/level6-hint2.html">Hint</a></li>
</ul>
<h4 id="solution-5">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-5">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># We need to get a gzipped object using S3 select</span>
</span></span><span class="line"><span class="cl">aws s3api list-objects --bucket s3game-level6-vjv45x1gux81 --profile tmp
</span></span><span class="line"><span class="cl"><span class="c1"># Now, do the select on s3select.csv.gz</span>
</span></span><span class="line"><span class="cl">aws s3api <span class="k">select</span>-object-content --bucket s3game-level6-vjv45x1gux81 --key s3select.csv.gz --expression <span class="s2">&#34;SELECT s.Answer FROM s3object s WHERE Category = &#39;TREASURE&#39;&#34;</span> --expression-type sql --input-serialization <span class="s1">&#39;{&#34;CSV&#34;: {&#34;FileHeaderInfo&#34;: &#34;USE&#34;, &#34;FieldDelimiter&#34;: &#34;;&#34;}, &#34;CompressionType&#34;: &#34;GZIP&#34;}&#39;</span> --output-serialization <span class="s1">&#39;{&#34;CSV&#34;: {}}&#39;</span> --profile tmp treasure6
</span></span></code></pre></div><h3 id="level-7httpss3game-level7-zhovpo4j8588s3us-east-2amazonawscomlevel7html"><a href="https://s3game-level7-zhovpo4j8588.s3.us-east-2.amazonaws.com/level7.html">Level 7</a><a hidden class="anchor" aria-hidden="true" href="#level-7httpss3game-level7-zhovpo4j8588s3us-east-2amazonawscomlevel7html">#</a></h3>
<ul>
<li><a href="https://s3game-level7-zhovpo4j8588.s3.us-east-2.amazonaws.com/level7-hint2.html">Hint</a></li>
</ul>
<h4 id="solution-6">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-6">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Get &#39;somethingstrange&#39; from the bucket</span>
</span></span><span class="line"><span class="cl">aws s3api get-object --bucket s3game-level7-zhovpo4j8588 --key somethingstrange --profile tmp t7
</span></span><span class="line"><span class="cl">cat t7
</span></span><span class="line"><span class="cl"><span class="c1"># Visit the pre-signed URL in the file to get URL for next level</span>
</span></span></code></pre></div><h4 id="takeaway-2">Takeaway<a hidden class="anchor" aria-hidden="true" href="#takeaway-2">#</a></h4>
<p>Pre-signed URLs are a powerful feature of S3. From the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/s3-presigned-urls.html">docs</a>:</p>
<blockquote>
<p>A presigned URL is generated by an AWS user who has access to the object. The generated URL is then given to the unauthorized user. The presigned URL can be entered in a browser or used by a program or HTML webpage. The credentials used by the presigned URL are those of the AWS user who generated the URL.</p>
<p>A presigned URL remains valid for a <strong>limited period of time</strong> which is specified when the URL is generated.</p>
</blockquote>
<h3 id="level-8httpss3game-level8-v6g8tp7ra2lds3us-east-2amazonawscomlevel8html"><a href="https://s3game-level8-v6g8tp7ra2ld.s3.us-east-2.amazonaws.com/level8.html">Level 8</a><a hidden class="anchor" aria-hidden="true" href="#level-8httpss3game-level8-v6g8tp7ra2lds3us-east-2amazonawscomlevel8html">#</a></h3>
<h4 id="solution-7">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-7">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># List objects</span>
</span></span><span class="line"><span class="cl">aws s3api list-objects --bucket s3game-level8-v6g8tp7ra2ld --profile tmp
</span></span><span class="line"><span class="cl"><span class="c1"># Visit the treasure file using the cloudfront URL</span>
</span></span><span class="line"><span class="cl">curl <span class="s1">&#39;https://d2suiw06vujwz3.cloudfront.net/treasure8_CDN&#39;</span>
</span></span></code></pre></div><h4 id="takeaway-3">Takeaway<a hidden class="anchor" aria-hidden="true" href="#takeaway-3">#</a></h4>
<ul>
<li>You can easily create a Cloudfront distribution backed by an S3 bucket</li>
<li>In such cases, you can restrict public access for the objects in the bucket as they can be accessed using Cloudfront</li>
<li>Ensure that your bucket does not allow unprivileged users to list all objects in the bucket</li>
</ul>
<h3 id="level-9httpss3game-level9-781xtls2quvys3us-east-2amazonawscomlevel9html"><a href="https://s3game-level9-781xtls2quvy.s3.us-east-2.amazonaws.com/level9.html">Level 9</a><a hidden class="anchor" aria-hidden="true" href="#level-9httpss3game-level9-781xtls2quvys3us-east-2amazonawscomlevel9html">#</a></h3>
<ul>
<li><a href="https://s3game-level9-781xtls2quvy.s3.us-east-2.amazonaws.com/level9-hint2.html">Hint</a></li>
</ul>
<p>The bucket has a policy which checks that any request for &ldquo;arn:aws:s3:::s3game-level9-781xtls2quvy/treasure9_referer&rdquo; has the referer string &ldquo;<a href="http://s3game.treasure">http://s3game.treasure</a>&rdquo;</p>
<h4 id="solution-8">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-8">#</a></h4>
<p>All we need to do is curl with a &ndash;refer given in policy
curl &lsquo;<a href="https://s3game-level9-781xtls2quvy.s3.us-east-2.amazonaws.com/treasure9_referer'">https://s3game-level9-781xtls2quvy.s3.us-east-2.amazonaws.com/treasure9_referer'</a> &ndash;refer &lsquo;<a href="http://s3game.treasure">http://s3game.treasure</a>&rsquo;</p>
<h3 id="level-10httpss3game-level10-gac6tf83erp6s3us-east-2amazonawscomlevel10html"><a href="https://s3game-level10-gac6tf83erp6.s3.us-east-2.amazonaws.com/level10.html">Level 10</a><a hidden class="anchor" aria-hidden="true" href="#level-10httpss3game-level10-gac6tf83erp6s3us-east-2amazonawscomlevel10html">#</a></h3>
<p>Here, we need to fetch an object which is in Infrequent Access storage.</p>
<h4 id="solution-9">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-9">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># We can use the powerful query param of aws cli to just fetch those objects which are in infrequent access storgae</span>
</span></span><span class="line"><span class="cl">aws s3api list-objects --bucket s3game-level10-gac6tf83erp6 --query <span class="s1">&#39;Contents[?StorageClass == `STANDARD_IA`]&#39;</span> --profile tmp
</span></span></code></pre></div><h4 id="takeaway-4">Takeaway<a hidden class="anchor" aria-hidden="true" href="#takeaway-4">#</a></h4>
<blockquote>
<p>Amazon S3 offers a range of storage classes designed for different use cases:</p>
<ul>
<li>Standard for general-purpose storage of frequently accessed data</li>
<li>Intelligent-Tiering for data with unknown or changing access patterns</li>
<li>Standard-Infrequent Access (Standard-IA) and One Zone-Infrequent Access (One Zone-IA) for long-lived, but less frequently accessed data</li>
<li>Glacier and Glacier Deep Archive for long-term archive</li>
</ul>
</blockquote>
<h3 id="level-11httpss3game-level11-djq30a807iyqs3us-east-2amazonawscomlevel11html"><a href="https://s3game-level11-djq30a807iyq.s3.us-east-2.amazonaws.com/level11.html">Level 11</a><a hidden class="anchor" aria-hidden="true" href="#level-11httpss3game-level11-djq30a807iyqs3us-east-2amazonawscomlevel11html">#</a></h3>
<p>Here we need to fetch an object which has been encrypted using client side encryption and uploaded to S3. This means that we can not fetch the object unless we have the encryption key.</p>
<h4 id="solution-10">Solution<a hidden class="anchor" aria-hidden="true" href="#solution-10">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># The encryption key is given in the hint</span>
</span></span><span class="line"><span class="cl">aws s3 cp --sse-c <span class="s1">&#39;AES256&#39;</span> --sse-c-key <span class="s1">&#39;UkXp2s5v8y/B?E(H+MbPeShVmYq3t6w9&#39;</span> <span class="s1">&#39;s3://s3game-level11-djq30a807iyq/treasure11_encryption&#39;</span> --profile tmp .
</span></span><span class="line"><span class="cl"><span class="c1"># Alternate way using aws s3api. Here we also need to give md5 of encryption key as additional integrity check</span>
</span></span><span class="line"><span class="cl">aws s3api get-object --bucket s3game-level11-djq30a807iyq --key treasure11_encryption --sse-customer-key <span class="s1">&#39;UkXp2s5v8y/B?E(H+MbPeShVmYq3t6w9&#39;</span> --sse-customer-algorithm AES256 --profile tmp treasure11_encryption
</span></span></code></pre></div><h4 id="takeaway-5">Takeaway<a hidden class="anchor" aria-hidden="true" href="#takeaway-5">#</a></h4>
<p>S3 supports both <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/serv-side-encryption.html">server side</a> and <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingClientSideEncryption.html">client side encryption</a>.</p>
<h3 id="victory---level-12httpss3game-level12-bk0m5ax5n92os3us-east-2amazonawscomlevel12html">VICTORY! - <a href="https://s3game-level12-bk0m5ax5n92o.s3.us-east-2.amazonaws.com/level12.html">Level 12</a><a hidden class="anchor" aria-hidden="true" href="#victory---level-12httpss3game-level12-bk0m5ax5n92os3us-east-2amazonawscomlevel12html">#</a></h3>
<p>Congrats! You have cleared the game!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://rrampage.github.io/tags/aws/">aws</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://rrampage.github.io/2021/12/04/relearning-lua/">
    <span class="title">« Prev</span>
    <br>
    <span>Re-learning Lua</span>
  </a>
  <a class="next" href="https://rrampage.github.io/2020/05/28/npm-and-node-tips-to-make-your-dev-machine-slightly-safer/">
    <span class="title">Next »</span>
    <br>
    <span>NPM and Node tips to make your dev machine (slightly) safer</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://rrampage.github.io/">A Random Walk</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
