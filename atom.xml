<feed xmlns="http://www.w3.org/2005/Atom">
  <title>A Random Walk</title>
  <link href="https://rrampage.github.io/index.xml" rel="self"/>
  <link href="https://rrampage.github.io/"/>
  <updated>2021-12-04T00:00:00+05:30</updated>
  <id>https://rrampage.github.io/</id>
  <author>
    <name>Raunak</name>
  </author>
  <generator>Hugo -- gohugo.io</generator>
  <entry>
    <title type="html"><![CDATA[Re-learning Lua]]></title>
    <link href="https://rrampage.github.io/2021/12/04/relearning-lua/"/>
    <id>https://rrampage.github.io/2021/12/04/relearning-lua/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>2021-12-04T00:00:00+05:30</published>
    <updated>2021-12-04T00:00:00+05:30</updated>
    
    <content type="html"><![CDATA[<h2 id="lua---basics">Lua - Basics</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span> <span class="kr">do</span> <span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="kr">end</span> <span class="c1">-- for loop with range and step. step if not given is assumed to be 1</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Tables are the soul of Lua. They double up as arrays and hashes</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- b[1] will return 1 as indexing for arrays is from 1</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="p">{[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">123</span><span class="p">,</span><span class="mi">3</span><span class="p">},[</span><span class="s2">&#34;a&#34;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">v</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- We can have a &#34;0&#34;th index by adding the 1st element as [0]=value</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- Adding keys which are not valid identifiers in Lua needs to be done by wrapping key in []</span>
</span></span><span class="line"><span class="cl"><span class="c1">-- If a key is a valid identifier, we can access using `.` e.g c.a for above code vs c[0]</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="kr">do</span> <span class="n">print</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="kr">end</span> <span class="c1">-- iterates through k/v in table and prints type of key</span>
</span></span></code></pre></div><h3 id="print-a-table-as-valid-lua-code">Print a table as valid Lua code</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="kr">function</span> <span class="nf">printTable</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="c1">-- Specify function vars as local else they become global</span>
</span></span><span class="line"><span class="cl">        <span class="kd">local</span> <span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;{&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">local</span> <span class="n">fst</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="kr">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="n">pairs</span><span class="p">(</span><span class="n">tbl</span><span class="p">)</span> <span class="kr">do</span>
</span></span><span class="line"><span class="cl">        	    <span class="kd">local</span> <span class="n">tk</span> <span class="o">=</span> <span class="n">type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        	    <span class="kd">local</span> <span class="n">tv</span> <span class="o">=</span> <span class="n">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="kr">if</span> <span class="ow">not</span> <span class="n">fst</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">                        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="s2">&#34;,&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="kr">else</span>
</span></span><span class="line"><span class="cl">                        <span class="n">fst</span> <span class="o">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                <span class="kr">end</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="kr">if</span> <span class="n">tk</span> <span class="o">==</span> <span class="s2">&#34;number&#34;</span> <span class="ow">or</span> <span class="n">tk</span> <span class="o">==</span> <span class="s2">&#34;boolean&#34;</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">                        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="s2">&#34;[&#34;</span> <span class="o">..</span> <span class="n">tostring</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&#34;]=&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="kr">else</span>
</span></span><span class="line"><span class="cl">                        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="s1">&#39;[&#34;&#39;</span> <span class="o">..</span> <span class="n">k</span> <span class="o">..</span> <span class="s1">&#39;&#34;]=&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="kr">end</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="kr">if</span> <span class="n">tv</span> <span class="o">==</span> <span class="s2">&#34;table&#34;</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="n">printTable</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="kr">elseif</span> <span class="n">tv</span> <span class="o">==</span> <span class="s2">&#34;number&#34;</span> <span class="ow">or</span> <span class="n">tv</span> <span class="o">==</span> <span class="s2">&#34;boolean&#34;</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="n">tostring</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="kr">elseif</span> <span class="n">tv</span> <span class="o">==</span> <span class="s2">&#34;string&#34;</span> <span class="kr">then</span>
</span></span><span class="line"><span class="cl">                    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="s1">&#39;&#34;&#39;</span> <span class="o">..</span> <span class="n">v</span> <span class="o">..</span> <span class="s1">&#39;&#34;&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="kr">else</span>
</span></span><span class="line"><span class="cl">                	<span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="n">vt</span>
</span></span><span class="line"><span class="cl">                <span class="kr">end</span>
</span></span><span class="line"><span class="cl">        <span class="kr">end</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">..</span> <span class="s2">&#34;}&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="kr">return</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl"><span class="kr">end</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sv</span> <span class="o">=</span> <span class="n">printTable</span><span class="p">({[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">123</span><span class="p">,</span><span class="mi">3</span><span class="p">},[</span><span class="s2">&#34;a&#34;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span><span class="n">v</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">},[</span><span class="kc">true</span><span class="p">]</span><span class="o">=</span><span class="mi">123</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">print</span><span class="p">(</span><span class="n">sv</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="line"><span class="cl"><span class="c1">-- posts.lua (saved table) can be read from another lua file as posts=require(&#34;posts&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="kr">return</span> <span class="p">{[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">{[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">123</span><span class="p">,[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span><span class="p">},[</span><span class="s2">&#34;v&#34;</span><span class="p">]</span><span class="o">=</span><span class="p">{[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">,[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">6</span><span class="p">,[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="mi">7</span><span class="p">},[</span><span class="s2">&#34;a&#34;</span><span class="p">]</span><span class="o">=</span><span class="p">{[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">,[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span><span class="p">},[</span><span class="kc">true</span><span class="p">]</span><span class="o">=</span><span class="mi">123</span><span class="p">}</span>
</span></span></code></pre></div>]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[A Primer on JVM Memory Management and Troubleshooting - 1]]></title>
    <link href="https://rrampage.github.io/2018/05/15/a-primer-on-jvm-memory-management-and-troubleshooting-1/"/>
    <id>https://rrampage.github.io/2018/05/15/a-primer-on-jvm-memory-management-and-troubleshooting-1/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>2018-05-15T14:14:49+00:00</published>
    <updated>2018-05-15T14:14:49+00:00</updated>
    
    <content type="html"><![CDATA[<p>This series is a summary of Oracle&rsquo;s <a href="https://apexapps.oracle.com/pls/apex/f?p=44785:149:105166169953256::NO:RP,149:P149_EVENT_ID:5552">JVM troubleshooting course</a> which gives an overview on JVM memory management, Hotspot VM&rsquo;s garbage collection options, various memory errors and how to troubleshoot them.</p>
<p>In this post (part 1), we will have a look at how JVM manages memory and its different garbage collectors.</p>
<p>You can find Part 2 <a href="https://dev.to/rrampage/jvm-primer-part-2---debugging-performance-issues-1od">here</a></p>
<h3 id="jvm-memory-management-overview">JVM Memory Management Overview</h3>
<p>The JVM provides automatic memory management to free the programmer from manually managing memory. New objects are allocated on heap memory. A <strong>root set</strong> consists of pointers to external memory, static variables, threads, <a href="https://en.wikipedia.org/wiki/Java_Native_Interface">JNI</a> references and internal JVM structures. Objects directly reachable from the root set must be kept in heap. Objects reachable from any of the reachable objects must also be in heap. This group of objects are the only ones which can be used by a program. The unreachable objects (garbage) are removed using a process called <strong>garbage collection (GC)</strong>. Reachable objects are <strong>compacted</strong> i.e moved to contiguous space in heap. This is important as otherwise, the heap will become <a href="https://en.wikipedia.org/wiki/Fragmentation_(computing)">fragmented</a>.</p>
<h3 id="generational-gc-and-memory-spaces-in-hotspot">Generational GC and Memory Spaces in Hotspot</h3>
<p>When the JVM starts, it requests some memory from the OS. This memory is divided into various spaces.</p>
<p><img loading="lazy" src="https://www.ibm.com/support/knowledgecenter/SS3JSW_5.2.0/com.ibm.help.performance_mgmt.doc/SIPM_HotSpotMemory.jpg" alt="Memory spaces in Hotspot"  title="Memory spaces in Hotspot VM"  />

Memory spaces in JVM prior to JDK 8</p>
<ul>
<li>Separate pools hold objects of diff age ranges</li>
<li>JVM&rsquo;s GC is <strong>generational</strong> and is based on the hypothesis that:
<ul>
<li>Most objects die young</li>
<li>Few references from older to younger objects</li>
</ul>
</li>
<li>There are 2 generations of objects:
<ul>
<li>young : small and collected frequently (minor collection). Objects which survive a threshold number of GCs move to old generation.</li>
<li>old : large, collected infrequently (major collection = Full GC)</li>
</ul>
</li>
<li>Prior to JDK 8, there was also a <strong>permanent generation</strong> which was for storing class representations and metadata, interned strings and class statics. This was replaced by meta-space in JDK 8 and later.</li>
<li><strong>Meta-space</strong> is allocated in native memory. It is managed through JVM options <strong>MetaspaceSize</strong> for initial size and <strong>MaxMetaspaceSize</strong> for maximum.
<ul>
<li>If <strong>UseCompressedClassPointers</strong> is enabled, 2 areas of memory are used for storing classes and their metadata - <strong>meta-space</strong> and <strong>compressed class space</strong>. 64 bit class pointers represented with 32 bit offsets to save space. Class metadata is referenced by 32 bit offsets stored in compressed class space. By default, compressed class space is 1 GB.</li>
</ul>
</li>
<li>Code cache is used to store compiled code generated by JIT (Just in time optimizer), allocated out of native memory and managed by Code Cache Sweeper</li>
</ul>
<h3 id="garbage-collectors-in-hotspot-jvm">Garbage Collectors in Hotspot JVM</h3>
<p>The JVM has different garbage collection methods for different generations of objects. Some of them are described below:</p>
<ul>
<li>Young generation collection
<ul>
<li>Serial - Stop-the-world (STW), copying collector, single threaded</li>
<li>ParNew - STW, copying collector, multiple GC threads</li>
<li>Parallel Scavenge - STW, copying collector, multiple GC threads</li>
</ul>
</li>
<li>Old generation collection
<ul>
<li>Serial Old - STW, mark-sweep-compact collector, single threaded</li>
<li>CMS - Mostly concurrent, low pause</li>
<li>Parallel Old - compacting collector, multiple GC threads</li>
</ul>
</li>
<li>G1 : designed for large heaps and offers predictable short pauses.
<ul>
<li>Has different memory layout for generations</li>
<li>Same collector for all generations</li>
</ul>
</li>
</ul>
<h3 id="gc-options-for-jdk">GC options for JDK</h3>
<p>These are the option flags passed to JVM for specifying which GC to use:</p>
<ul>
<li>UseSerialGC : Serial + SerialOld</li>
<li>UseParNewGC : ParNew + SerialOld . In JDK 9, uses CMS for old gen</li>
<li>UseConcMarkSweepGC : ParNew + CMS + SerialOld
<ul>
<li>CMS used most of time to collect old generation. SerialOld used when concurrent mode failure occurs.</li>
<li>CMS performs most work in concurrent with application threads.</li>
<li>No heap compaction leads to fragmentation. Has floating garbage and requires larger heap sizes.</li>
<li>Free space maintained as linked lists. Allocation expensive compared to bump-the-pointer allocations.</li>
<li>Additional overhead on young collections</li>
<li>Deprecated in JDK 9</li>
</ul>
</li>
<li>UseParallelGC : Parallel Scavenge + Parallel Old.
<ul>
<li>Maximizes throughput.</li>
<li>Default GC till JDK 9</li>
</ul>
</li>
<li>UseG1GC - G1 for both generations
<ul>
<li>Server style GC for multi-core machines with large memory</li>
<li>Low GC pauses with high probability while trying for high throughput</li>
<li>Compacting collector. Low pauses without fragmentation</li>
<li>Better GC ergonomics. Parallel threads and some tasks are concurrent with application threads</li>
<li>Available since JDK 7u4 and default in JDK 9</li>
</ul>
</li>
</ul>
<p>For more detailed information on tuning the garbage collector, read the official <a href="https://docs.oracle.com/javase/9/gctuning/toc.htm">GC Tuning Guide</a></p>
<h4 id="minor-gc-or-how-young-generation-is-collected">Minor GC or How young generation is collected:</h4>
<ol>
<li>When Eden space in young gen is full, reachable objects are marked and moved to the ToSurvivorSpace</li>
<li>Objects in FromSurvivor space that are reachable are moved to ToSurvivorSpace</li>
<li>Objects in FromSurvivor space that have crossed the threshold are promoted to the old generation</li>
<li>Eden becomes empty and is ready for new allocations</li>
<li>To and From Survivor Spaces are switched</li>
</ol>
<h4 id="notes-on-mark-sweep-compact-collector-serial-old">Notes on Mark-Sweep-Compact collector (Serial Old):</h4>
<ul>
<li>Mark phase : marks all live objects</li>
<li>Sweep phase : sweeps over heap identifying garbage</li>
<li>Slide phase : GC performs a sliding compaction by sliding live objects to the start of the heap</li>
</ul>
]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[Snake case to camel case and back using regular expressions and Python]]></title>
    <link href="https://rrampage.github.io/2018/05/09/snake-case-to-camel-case-and-back-using-regular-expressions-and-python/"/>
    <id>https://rrampage.github.io/2018/05/09/snake-case-to-camel-case-and-back-using-regular-expressions-and-python/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>2018-05-09T00:10:00+05:30</published>
    <updated>2018-05-09T00:10:00+05:30</updated>
    
    <content type="html"><![CDATA[<p><a href="https://en.wikipedia.org/wiki/Snake_case">Snake case</a> and <a href="https://en.wikipedia.org/wiki/Camel_case">Camel case</a> are conventions of naming variables, functions and classes. Most teams and projects prescribe a particular case in their style guides.</p>
<p>Examples of camel case:</p>
<pre tabindex="0"><code>MyClass
MyClassFactory
MyClassFactoryBuilder
MyClassFactoryBuilderImpl
myInstance
myInstance2
abc
patternMatcher
</code></pre><p>Examples of snake case:</p>
<pre tabindex="0"><code>add
matrix_add
diagonal_matrix_add
pseudo_inverse
</code></pre><p>If we want to convert back and forth between these cases, we must look for the points of interest - the word boundaries. Camel case boundaries have the first letter capitalized while the snake case word boundaries have an <strong><code>_</code></strong>.</p>
<h3 id="snake-case-to-camel-case">Snake case to camel case</h3>
<p>Here is a regular expression for finding out the <strong><code>_</code></strong> and the first letter in the next word:</p>
<pre tabindex="0"><code class="language-regex" data-lang="regex">(.*?)_([a-zA-Z])
</code></pre><p>This regex has 2 parts:</p>
<ol>
<li>
<p><strong><code>(.*?)</code></strong> finds everything upto the <strong><code>_</code></strong>.</p>
<ul>
<li>The &lsquo;.&rsquo; means any character.</li>
<li>&lsquo;*&rsquo; stands for match 0 or more instances</li>
<li>&lsquo;?&rsquo; stands for non-greedy match. We must use &lsquo;?&rsquo; in the pattern because the regex engine will try to match as much as possible by default. So, if we use just <strong><code>(.*)</code></strong>, the whole word will be consumed and nothing will be left for the rest of the pattern.</li>
<li>&lsquo;()&rsquo; stand for a group. A group is a way of saving a part of the match for later.</li>
<li>Together, they mean that find all characters upto the first &lsquo;_&rsquo; and capture them in a group.</li>
</ul>
</li>
<li>
<p><strong><code>([a-zA-Z])</code></strong> finds the first alphabet after the <strong><code>_</code></strong>. We need this to convert to upper case for Camel case.</p>
</li>
</ol>
<p>The Python code below converts words which are in snake case to camel case:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">REG</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;(.*?)_([a-zA-Z])&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">camel</span><span class="p">(</span><span class="k">match</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">camel_upper</span><span class="p">(</span><span class="k">match</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">words</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;add
</span></span></span><span class="line"><span class="cl"><span class="s2">matrix_add
</span></span></span><span class="line"><span class="cl"><span class="s2">diagonal_matrix_add
</span></span></span><span class="line"><span class="cl"><span class="s2">pseudo_inverse&#34;&#34;&#34;</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">REG</span><span class="p">,</span> <span class="n">camel</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Output:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [&#39;add&#39;, &#39;matrixAdd&#39;, &#39;diagonalMatrixAdd&#39;, &#39;pseudoInverse&#39;]</span>
</span></span></code></pre></div><p>We use the regex we constructed earlier and the <a href="https://docs.python.org/3/library/re.html#re.sub"><strong><code>re.sub</code></strong></a> method to substitute our matched words. We pass a method called <code>camel</code> as an argument. This method allows us to change the case of the letter in the second group and keep the first group unchanged. Notice that the first letter can be either lower or upper depending on whether it is a variable or method (lower) or a class (upper). The <code>camel_upper</code> method can be used for class names.</p>
<h3 id="camel-case-to-snake-case">Camel case to snake case</h3>
<p>Similarly, for converting from camel to snake case, the regex is:</p>
<pre tabindex="0"><code class="language-regex" data-lang="regex">(.+?)([A-Z])
</code></pre><p>And the Python code :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">REG</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;(.+?)([A-Z])&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">snake</span><span class="p">(</span><span class="k">match</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">words</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;MyClass
</span></span></span><span class="line"><span class="cl"><span class="s2">MyClassFactory
</span></span></span><span class="line"><span class="cl"><span class="s2">MyClassFactoryBuilder
</span></span></span><span class="line"><span class="cl"><span class="s2">MyClassFactoryBuilderImpl
</span></span></span><span class="line"><span class="cl"><span class="s2">myInstance
</span></span></span><span class="line"><span class="cl"><span class="s2">myInstance2
</span></span></span><span class="line"><span class="cl"><span class="s2">abc
</span></span></span><span class="line"><span class="cl"><span class="s2">patternMatcher&#34;&#34;&#34;</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">REG</span><span class="p">,</span> <span class="n">snake</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Output</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [&#39;my_class&#39;, &#39;my_class_factory&#39;, &#39;my_class_factory_builder&#39;, &#39;my_class_factory_builder_impl&#39;, &#39;my_instance&#39;, &#39;my_instance2&#39;, &#39;abc&#39;, &#39;pattern_matcher&#39;]</span>
</span></span></code></pre></div>]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[Cargo refused to build my project - A Rust debugging story!]]></title>
    <link href="https://rrampage.github.io/2018/05/09/cargo-refused-to-build-my-project-a-rust-debugging-story/"/>
    <id>https://rrampage.github.io/2018/05/09/cargo-refused-to-build-my-project-a-rust-debugging-story/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>2018-05-09T00:00:00+05:30</published>
    <updated>2018-05-09T00:00:00+05:30</updated>
    
    <content type="html"><![CDATA[<h3 id="background">Background</h3>
<p>Today, I resumed a <code>rust</code> project of mine after a long time. In order to check my last working code, I ran <code>cargo run</code>. But it refused to run with error message:</p>
<pre tabindex="0"><code>....&#34;-Wl,-Bdynamic&#34; &#34;-l&#34; &#34;dl&#34; &#34;-l&#34; &#34;rt&#34; &#34;-l&#34; &#34;pthread&#34; &#34;-l&#34; &#34;pthread&#34; &#34;-l&#34; &#34;gcc_s&#34; &#34;-l&#34; &#34;c&#34; &#34;-l&#34; &#34;m&#34; &#34;-l&#34; &#34;rt&#34; &#34;-l&#34; &#34;pthread&#34; &#34;-l&#34; &#34;util&#34; &#34;-l&#34; &#34;util&#34;
= note: /usr/bin/ld: cannot find Scrt1.o: No such file or directory
          collect2: error: ld returned 1 exit status
</code></pre><h3 id="linker-issues">Linker Issues!</h3>
<p><code>ld</code> is used to link libraries. So, the error was not in the code but in the linking phase. I googled the error and the solution was to have <code>build-essential</code> package installed. But the package was already installed on my machine (it is one of the first packages I install on any development machine).</p>
<p>Some more googling revealed that <code>cargo</code> uses the system <code>cc</code> linker to link to the C runtime. Running <code>which cc</code> gave me <code>$HOME/anaconda3/bin/cc</code>. This <code>cc</code> is part of my Anaconda root environment. (Anaconda is a package manager for scientific computing packages. It is a convenient way for installing multiple versions of packages in different environments).</p>
<p>On Linux, the linker knows where to find the required libraries using the shared library cache. I ran <code>ldconfig -v</code> to refresh it and then try again. Same error!</p>
<p>It is possible to explicitly list directories to include using <code>LD_LIBRARY_PATH</code> environment variable. I tried setting the <code>LD_LIBRARY_PATH</code> to point to the required directory and then run cargo as <code>LD_LIBRARY_PATH=DIR cargo build -v</code>. But it gave the same error.</p>
<p>I thought that <code>cargo</code> must be setting the linker value somewhere, so instead let me try directly compiling with <code>rustc</code>. Even that gave the same error. With this, I eliminated the possibility of some environment variable only affecting <code>cargo</code>.</p>
<h3 id="more-googling">More googling!</h3>
<p>Further searching for the error with &ldquo;rust&rdquo; added showed me results of people having trouble cross-compiling. From this, I learned that cargo has different targets i.e different instruction sets (e,g x86-64, arm, x86, mips), different OSs (e.g linux, windows, freebsd) and different C runtimes (e.g glibc, musl, msvc). The Rust documentation on cargo mentioned that this is called a target triple. The <a href="https://doc.rust-lang.org/cargo/reference/"><strong>Cargo book</strong></a> mentioned that you can direct cargo to explicitly use a particular linker using RUSTFLAGS environment variable.</p>
<p>Since I am only building for my machine, I had to find out the exact value of the target. Rust gives an exhaustive list of all supported targets by running <code>rustc --print target-list</code>. My target was <code>x86_64-unknown-linux-gnu</code>.</p>
<p>It is possible to pass a linker to <code>cargo</code> explicitly as <code>RUSTFLAGS=&quot;-C linker=x86_64-unknown-linux-gnu&quot; cargo build -v</code>. It worked!</p>
<h3 id="all-time-fix">All-time fix!</h3>
<p>I do not want to do this every time I run <code>cargo</code>. The Cargo book says that cargo uses a global config file in <code>$HOME/.cargo/config</code>.</p>
<p>I added the following to the file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="c"># Specify which linker to use for this target</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">target</span><span class="p">.</span><span class="nx">x86_64-unknown-linux-gnu</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">linker</span> <span class="p">=</span> <span class="s2">&#34;x86_64-linux-gnu-gcc&#34;</span>
</span></span></code></pre></div><p>Now, <code>cargo build</code> works without issues.</p>
]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[Disk Space Debugging Checklist]]></title>
    <link href="https://rrampage.github.io/2018/05/04/disk-space-debugging-checklist/"/>
    <id>https://rrampage.github.io/2018/05/04/disk-space-debugging-checklist/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>2018-05-04T00:00:00+05:30</published>
    <updated>2018-05-04T00:00:00+05:30</updated>
    
    <content type="html"><![CDATA[<p>Many times, smoothly running processes stop working mysteriously. You open the logs and see what is happening, only to find that even the logs have stopped updating. But the process itself is running. You SSH to the server and type cd TAB. Bash weeps &ldquo;Unable to create temporary file&rdquo;. The machine is out of disk space&hellip;</p>
<p>Here is a checklist to make disk space debugging easier, using standard Linux utilities so you can get started without having to install anything extra:</p>
<ol>
<li><strong><code>df -h</code></strong> command gives you an overview in a readable format about the number of disks mounted and their total and available capacities.</li>
<li>To get an idea of which folders/directories are eating up the maximum space, try out <strong><code>du -ch / | sort -h | tail -n 30</code></strong>. This gives you the 30 most space consuming directories. If you already know which directories generate maximum disk output e.g logs and temp files, you can replace the &lsquo;/&rsquo; with your directory (DIR) and run the command as <strong><code>du -ch DIR | sort -h | tail -n 30</code></strong></li>
<li>Now that we have identified the directories with maximum space consumed, we may need to delete some files and get our process going again. The <strong><code>rm</code></strong> command is your friend here. You can delete old logs and temporary files to free up space.</li>
<li>Many times, the culprit is a single large file which is already in use by a program e.g <code>catalina.out</code> by Apache Tomcat. If you want to free up space without shutting down the process, the <strong><code>truncate</code></strong> command will help you out. Example: <strong><code>truncate -s0 BIG_LOG.log</code></strong>. This will truncate the file to 0 bytes and still allow the other process to use it without issues (standard Unix permissions apply)</li>
<li>Sometimes, you delete files and still, the space does not seem to be recovered. This can be because some process is still holding on to the file descriptor of the deleted file. Once these processes are stopped, the space will be recovered. The <strong><code>lsof</code></strong> command will help you out here. It stands for <em>list open files</em>. You can find out which processes are using deleted files as follows: <code>lsof | grep deleted | grep OLD_FILENAME</code>. The lsof command gives you the process name and the process id so you can run <code>kill</code> on the process. If you do not know the name of the deleted file, you can still run <code>lsof | grep deleted</code> and see the output to check for any familiar file / process.</li>
</ol>
<p>Finally, keep in mind that disk space is one of the metrics you should monitor on your server. This checklist must be used in a pinch. If you find yourself constantly having disk space issues, the solution is to set up periodic deletion/rotation of old log files, alerts when the disk space reaches a particular threshold or to increase the disk size if your processes require a lot of disk space e.g Kafka, MySQL and other databases.</p>
<p>Let me know if there are some other tools I am missing out on and your experiences dealing with disk space issues!</p>
]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[Hello World]]></title>
    <link href="https://rrampage.github.io/2014/03/03/hello-world/"/>
    <id>https://rrampage.github.io/2014/03/03/hello-world/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>2014-03-03T22:38:33+05:30</published>
    <updated>2014-03-03T22:38:33+05:30</updated>
    
    <content type="html"><![CDATA[<p><strong>Hello World!</strong></p>
]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[About]]></title>
    <link href="https://rrampage.github.io/about/"/>
    <id>https://rrampage.github.io/about/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>0001-01-01T00:00:00+00:00</published>
    <updated>0001-01-01T00:00:00+00:00</updated>
    
    <content type="html"><![CDATA[<h4 id="about-this-blog">About this blog:</h4>
<ul>
<li>the delights and frustrations of programming</li>
<li>new things I learn/stumble across while coding</li>
<li>interesting concepts/resources I come across</li>
<li>trying to explain a few topics</li>
</ul>
<h4 id="about-me">About Me</h4>
<p>I am a software developer. I work on mostly backend stuff.
I blog occasionally <a href="https://rrampage.github.io">here</a> or crosspost to <a href="https://dev.to/rrampage">dev.to</a>. You can reach out to me via various websites in the footer.</p>
<h4 id="-ask-me-about-">💬 Ask me about &hellip;</h4>
<ul>
<li>Bash, sed, awk, GNU Make, jq</li>
<li>Java/Kotlin, JOOQ, Dropwizard</li>
<li>Postgres</li>
<li>Solr &amp; Elasticsearch</li>
<li>ArangoDB</li>
<li>Nginx &amp; Openresty</li>
<li>Linux</li>
<li>State machines, Regexes, State charts</li>
</ul>
<h4 id="-how-to-reach-me">📫 How to reach me:</h4>
<ul>
<li>Github issues on <a href="https://github.com/rrampage/rrampage/issues">this repo</a></li>
<li>My DMs are open on <a href="https://dev.to/rrampage">dev.to</a></li>
<li><a href="https://in.linkedin.com/in/raunak1">LinkedIn</a></li>
<li><a href="https://twitter.com/QuixoticCoder">Twitter</a></li>
</ul>
]]></content>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[Archive]]></title>
    <link href="https://rrampage.github.io/archives/"/>
    <id>https://rrampage.github.io/archives/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>0001-01-01T00:00:00+00:00</published>
    <updated>0001-01-01T00:00:00+00:00</updated>
    
  </entry>
  <entry>
    <title type="html"><![CDATA[Search]]></title>
    <link href="https://rrampage.github.io/search/"/>
    <id>https://rrampage.github.io/search/</id> 
    <author>
      <name>Raunak</name>
    </author>
    <published>0001-01-01T00:00:00+00:00</published>
    <updated>0001-01-01T00:00:00+00:00</updated>
    
  </entry>
</feed>